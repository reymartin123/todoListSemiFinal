{"version":3,"sources":["propertyFields/roleDefinitionPicker/PropertyFieldRoleDefinitionPicker.ts"],"names":[],"mappings":";;AAAA,6BAA+B;AAC/B,oCAAsC;AACtC,8DAIoC;AACpC,iGAA4F;AAK5F;;GAEG;AACH;IAwBE;;OAEG;IACH,kDAAmB,eAAuB,EAAE,WAA4D;QAtBjG,SAAI,GAA0B,uCAAqB,CAAC,MAAM,CAAC;QAS1D,aAAQ,GAAY,KAAK,CAAC;QAC1B,gBAAW,GAAY,KAAK,CAAC;QAcnC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,IAAI,CAAC,cAAc,GAAG,eAAe,CAAC;QACtC,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC;QAC9B,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC;QACzC,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;QACvC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;QAC/B,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;QACnC,IAAI,CAAC,cAAc,GAAG,WAAW,CAAC,cAAc,CAAC;QACjD,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC,eAAe,CAAC;QACnD,IAAI,CAAC,sBAAsB,GAAG,WAAW,CAAC,sBAAsB,CAAC;QAEjE,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,gBAAgB,CAAC;QACrD,IAAI,CAAC,gBAAgB,GAAG,WAAW,CAAC,UAAU,CAAC;QAC/C,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;QAC3B,IAAI,CAAC,wBAAwB,GAAG,WAAW,CAAC,wBAAwB,CAAC;QAErE,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,iBAAiB,CAAC;QACvD,IAAI,CAAC,0BAA0B,GAAG,WAAW,CAAC,0BAA0B,CAAC;QACzE,EAAE,CAAC,CAAC,WAAW,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC;QACvC,CAAC;QACD,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;IAC7C,CAAC;IAED;;OAEG;IACK,yDAAM,GAAd,UAAe,IAAiB,EAAE,GAAS,EAAE,cAAkE;QAC7G,IAAM,cAAc,GAAG;YACrB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,eAAe,EAAE,IAAI,CAAC,eAAe;YACrC,SAAS,EAAE,IAAI,CAAC,OAAO;YACvB,QAAQ,EAAE,IAAI,CAAC,MAAM;YACrB,QAAQ,EAAE,cAAc;YACxB,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,UAAU,EAAE,IAAI,CAAC,gBAAgB;YACjC,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,iBAAiB,EAAE,IAAI,CAAC,iBAAiB;YACzC,wBAAwB,EAAE,IAAI,CAAC,wBAAwB;YACvD,sBAAsB,EAAE,IAAI,CAAC,sBAAsB;YACnD,0BAA0B,EAAE,IAAI,CAAC,0BAA0B;SAC5D,CAAC;QAEA,IAAM,OAAO,GAAoE,KAAK,CAAC,aAAa,CAAC,+CAAqC,EAAE,cAAc,CAAC,CAAC;QAC5J,oCAAoC;QACpC,QAAQ,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACnC,CAAC;IAED;;OAEG;IACK,0DAAO,GAAf,UAAgB,KAAkB;IAElC,CAAC;IAEH,+CAAC;AAAD,CAzFA,AAyFC,IAAA;AAED;;;;GAIG;AACH,2CAAkD,cAAsB,EAAE,UAAmD;IAE3H,gEAAgE;IAChE,IAAM,aAAa,GAAoD;QACrE,KAAK,EAAE,UAAU,CAAC,KAAK;QACvB,cAAc,EAAE,cAAc;QAC9B,OAAO,EAAE,UAAU,CAAC,OAAO;QAC3B,sBAAsB,EAAE,UAAU,CAAC,sBAAsB;QACzD,gBAAgB,EAAE,UAAU,CAAC,gBAAgB;QAC7C,UAAU,EAAE,UAAU,CAAC,UAAU;QACjC,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,GAAG,EAAE,UAAU,CAAC,GAAG;QACnB,eAAe,EAAE,UAAU,CAAC,eAAe;QAC3C,QAAQ,EAAE,UAAU,CAAC,QAAQ;QAC7B,wBAAwB,EAAE,UAAU,CAAC,wBAAwB;QAC7D,cAAc,EAAE,UAAU,CAAC,cAAc;QACzC,WAAW,EAAE,UAAU,CAAC,WAAW;QACnC,iBAAiB,EAAE,UAAU,CAAC,iBAAiB;QAC/C,0BAA0B,EAAE,UAAU,CAAC,0BAA0B;KAClE,CAAC;IACF,4DAA4D;IAC5D,iFAAiF;IACjF,MAAM,CAAC,IAAI,wCAAwC,CAAC,cAAc,EAAE,aAAa,CAAC,CAAC;AACrF,CAAC;AAxBD,8EAwBC","file":"propertyFields/roleDefinitionPicker/PropertyFieldRoleDefinitionPicker.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport {\n  IPropertyPaneField,\n  PropertyPaneFieldType,\n  IWebPartContext\n} from '@microsoft/sp-webpart-base';\nimport PropertyFieldRoleDefinitionPickerHost from './PropertyFieldRoleDefinitionPickerHost';\nimport { IPropertyFieldRoleDefinitionPickerHostProps } from './IPropertyFieldRoleDefinitionPickerHost';\nimport { IPropertyFieldRoleDefinitionPickerProps, IPropertyFieldRoleDefinitionPickerPropsInternal } from './IPropertyFieldRoleDefinitionPicker';\nimport { IRoleDefinitionInformation } from '.';\n\n/**\n * Represents a PropertyFieldRoleDefinitionPicker object\n */\nclass PropertyFieldRoleDefinitionPickerBuilder implements IPropertyPaneField<IPropertyFieldRoleDefinitionPickerPropsInternal> {\n\n  //Properties defined by IPropertyPaneField\n  public properties: IPropertyFieldRoleDefinitionPickerPropsInternal;\n  public targetProperty: string;\n  public type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\n\n  //Custom properties label: string;\n  private context: IWebPartContext;\n  private label: string;  \n  private selectedRoleDefinition: string[];\n  private roleDefinitionsToExclude: string[];\n  private roleDefinitions: IRoleDefinitionInformation[];  \n  private customProperties: any;  \n  private disabled: boolean = false;\n  private multiSelect: boolean = false;\n  private key: string;\n  private webAbsoluteUrl?: string;\n  private onGetErrorMessage: (value: IRoleDefinitionInformation[]) => string | Promise<string>;\n  private onRoleDefinitionsRetrieved?: (roleDefinitions: IRoleDefinitionInformation[]) => PromiseLike<IRoleDefinitionInformation[]> | IRoleDefinitionInformation[];\n  \n  private onPropertyChange: (propertyPath: string, oldValue: any, newValue: any) => void;\n\n\n  /**\n   * Constructor method\n   */\n  public constructor(_targetProperty: string, _properties: IPropertyFieldRoleDefinitionPickerPropsInternal) {\n\n    this.render = this.render.bind(this);\n    this.targetProperty = _targetProperty;\n    this.properties = _properties;\n    this.properties.onDispose = this.dispose;\n    this.properties.onRender = this.render;\n    this.label = _properties.label;\n    this.context = _properties.context;\n    this.webAbsoluteUrl = _properties.webAbsoluteUrl;\n    this.roleDefinitions = _properties.roleDefinitions;    \n    this.selectedRoleDefinition = _properties.selectedRoleDefinition;\n    \n    this.onPropertyChange = _properties.onPropertyChange;\n    this.customProperties = _properties.properties;\n    this.key = _properties.key;\n    this.roleDefinitionsToExclude = _properties.roleDefinitionsToExclude;\n    \n    this.onGetErrorMessage = _properties.onGetErrorMessage;    \n    this.onRoleDefinitionsRetrieved = _properties.onRoleDefinitionsRetrieved;\n    if (_properties.disabled === true) {\n      this.disabled = _properties.disabled;\n    }\n    this.multiSelect = _properties.multiSelect;    \n  }\n\n  /**\n   * Renders the RoleDefinitionPicker field content\n   */\n  private render(elem: HTMLElement, ctx?: any, changeCallback?: (targetProperty?: string, newValue?: any) => void): void {\n    const componentProps = {\n      label: this.label,\n      targetProperty: this.targetProperty,\n      context: this.context,\n      webAbsoluteUrl: this.webAbsoluteUrl,\n      roleDefinitions: this.roleDefinitions,\n      onDispose: this.dispose,\n      onRender: this.render,\n      onChange: changeCallback,\n      onPropertyChange: this.onPropertyChange,\n      properties: this.customProperties,\n      key: this.key,\n      disabled: this.disabled,\n      multiSelect: this.multiSelect,\n      onGetErrorMessage: this.onGetErrorMessage,      \n      roleDefinitionsToExclude: this.roleDefinitionsToExclude,\n      selectedRoleDefinition: this.selectedRoleDefinition,\n      onRoleDefinitionsRetrieved: this.onRoleDefinitionsRetrieved           \n    };      \n      \n      const element: React.ReactElement<IPropertyFieldRoleDefinitionPickerHostProps> = React.createElement(PropertyFieldRoleDefinitionPickerHost, componentProps);\n      // Calls the REACT content generator\n      ReactDom.render(element, elem);\n  }\n\n  /**\n   * Disposes the current object\n   */\n  private dispose(_elem: HTMLElement): void {\n\n  }\n\n}\n\n/**\n * Helper method to create a Role Definitions Picker on the PropertyPane.\n * @param targetProperty - Target property the SharePoint role definition picker is associated to.\n * @param properties - Strongly typed Role Definition Picker properties.\n */\nexport function PropertyFieldRoleDefinitionPicker(targetProperty: string, properties: IPropertyFieldRoleDefinitionPickerProps): IPropertyPaneField<IPropertyFieldRoleDefinitionPickerPropsInternal> {\n\n  //Create an internal properties object from the given properties\n  const newProperties: IPropertyFieldRoleDefinitionPickerPropsInternal = {\n    label: properties.label,\n    targetProperty: targetProperty,\n    context: properties.context,    \n    selectedRoleDefinition: properties.selectedRoleDefinition,\n    onPropertyChange: properties.onPropertyChange,\n    properties: properties.properties,\n    onDispose: null,\n    onRender: null,\n    key: properties.key,\n    roleDefinitions: properties.roleDefinitions,\n    disabled: properties.disabled,\n    roleDefinitionsToExclude: properties.roleDefinitionsToExclude,     \n    webAbsoluteUrl: properties.webAbsoluteUrl,\n    multiSelect: properties.multiSelect,\n    onGetErrorMessage: properties.onGetErrorMessage,\n    onRoleDefinitionsRetrieved: properties.onRoleDefinitionsRetrieved    \n  };\n  //Calls the PropertyFieldRoleDefinitionPicker builder object\n  //This object will simulate a PropertyFieldCustom to manage his rendering process\n  return new PropertyFieldRoleDefinitionPickerBuilder(targetProperty, newProperties);\n}\n"],"sourceRoot":"../../../src"}
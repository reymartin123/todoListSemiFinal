{"version":3,"sources":["propertyFields/filePicker/PropertyFieldFilePickerHost.tsx"],"names":[],"mappings":"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","file":"propertyFields/filePicker/PropertyFieldFilePickerHost.js","sourcesContent":["import * as React from 'react';\nimport { FilePicker, IFilePickerResult } from './filePickerControls';\nimport styles from './PropertyFieldFilePickerHost.module.scss';\nimport { IPropertyFieldFilePickerHostProps } from './IPropertyFieldFilePickerHost';\nimport { GeneralHelper } from '../../helpers/GeneralHelper';\nimport * as telemetry from '../../common/telemetry';\n\n/**\n* Renders the control for PropertyFieldFilePicker component\n*/\nexport default class PropertyFieldFilePickerHost extends React.Component<IPropertyFieldFilePickerHostProps> {\n\n  constructor(props: IPropertyFieldFilePickerHostProps) {\n    super(props);\n    telemetry.track('PropertyFieldFilePicker', {\n      disabled: props.disabled\n    });\n  }\n\n  public render(): JSX.Element {\n    return (\n      <div>\n        {this.props.filePickerResult && this.props.filePickerResult.fileAbsoluteUrl && (\n          <div className={styles.filePreview}>\n            {GeneralHelper.isImage(this.props.filePickerResult.fileName) &&\n              <img className={styles.filePreviewImage} src={this.props.filePickerResult.fileAbsoluteUrl} alt={this.props.filePickerResult.fileName} />\n            }\n            <div>\n              {this.props.filePickerResult.fileName}\n            </div>\n          </div>\n        )}\n\n        <FilePicker\n          required={this.props.required}\n          disabled={this.props.disabled}\n          bingAPIKey={this.props.bingAPIKey}\n          accepts={this.props.accepts ? this.props.accepts : []}\n          buttonIcon={this.props.buttonIcon ? this.props.buttonIcon : \"FileImage\"}\n          onSave={(filePickerResult: IFilePickerResult) => { this.handleFileSave(filePickerResult); }}\n          onChanged={(filePickerResult: IFilePickerResult) => { this.handleFileChange(filePickerResult); }}\n          context={this.props.context}\n          filePickerResult={this.props.filePickerResult}\n          buttonClassName={this.props.buttonClassName}\n          buttonLabel={this.props.buttonLabel}\n          label={this.props.label}\n          key={this.props.key}\n          itemsCountQueryLimit={this.props.itemsCountQueryLimit !== undefined ? this.props.itemsCountQueryLimit : 100}\n          hideWebSearchTab={this.props.hideWebSearchTab !== undefined ? this.props.hideWebSearchTab : true}\n          hideRecentTab={this.props.hideRecentTab !== undefined ? this.props.hideRecentTab : false}\n          hideSiteFilesTab={this.props.hideSiteFilesTab !== undefined ? this.props.hideSiteFilesTab : false}\n          hideLocalUploadTab={this.props.hideLocalUploadTab !== undefined ? this.props.hideLocalUploadTab : false}\n          hideLinkUploadTab={this.props.hideLinkUploadTab !== undefined ? this.props.hideLinkUploadTab : false}\n          hideOneDriveTab={this.props.hideOneDriveTab !== undefined ? this.props.hideOneDriveTab : false}\n          hideOrganisationalAssetTab={this.props.hideOrganisationalAssetTab !== undefined ? this.props.hideOrganisationalAssetTab : false}\n          panelClassName={this.props.panelClassName}\n          storeLastActiveTab={this.props.storeLastActiveTab}\n        />\n      </div>\n    );\n  }\n\n  private handleFileSave = async (filePickerResult: IFilePickerResult): Promise<void> => {\n\n    this.props.onSave(filePickerResult);\n\n    this.props.properties[this.props.targetProperty] = filePickerResult;\n    this.props.onPropertyChange(this.props.targetProperty, this.props.filePickerResult, filePickerResult);\n\n    if (typeof this.props.onChange !== 'undefined' && this.props.onChange !== null) {\n      this.props.onChange(this.props.targetProperty, filePickerResult);\n    }\n  }\n\n  private handleFileChange = async (filePickerResult: IFilePickerResult): Promise<void> => {\n\n    this.props.onChanged(filePickerResult);\n\n    if (typeof this.props.onChange !== 'undefined' && this.props.onChange !== null) {\n      this.props.onChange(this.props.targetProperty, filePickerResult);\n    }\n  }\n\n}\n"],"sourceRoot":"../../../src"}
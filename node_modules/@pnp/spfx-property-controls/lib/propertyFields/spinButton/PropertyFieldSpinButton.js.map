{"version":3,"sources":["propertyFields/spinButton/PropertyFieldSpinButton.ts"],"names":[],"mappings":"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","file":"propertyFields/spinButton/PropertyFieldSpinButton.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport {\n  IPropertyPaneField,\n  PropertyPaneFieldType\n} from '@microsoft/sp-webpart-base';\nimport {\n\tIPropertyFieldSpinButtonProps,\n\tIPropertyFieldSpinButtonPropsInternal\n} from './IPropertyFieldSpinButton';\nimport { IPropertyFieldSpinButtonHostProps } from './IPropertyFieldSpinButtonHost';\nimport PropertyFieldSpinButtonHost from './PropertyFieldSpinButtonHost';\n\nclass PropertyFieldSpinButtonBuilder implements IPropertyPaneField<IPropertyFieldSpinButtonProps> {\n\n\t//Properties defined by IPropertyPaneField\n\tpublic type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\n\tpublic targetProperty: string;\n\tpublic properties: IPropertyFieldSpinButtonPropsInternal;\n\tprivate elem: HTMLElement;\n\tprivate svalue: number;\n\tprivate changeCB?: (targetProperty?: string, newValue?: any) => void;\n\n\tpublic constructor(_targetProperty: string, _properties: IPropertyFieldSpinButtonProps) {\n\t\tthis.targetProperty = _targetProperty;\n\t\tthis.properties = {\n\t\t\tkey: _properties.key,\n\t\t\tlabel: _properties.label,\n\t\t\tstep: _properties.step || 1,\n\t\t\tmin: _properties.min,\n\t\t\tmax: _properties.max,\n\t\t\tonPropertyChange: _properties.onPropertyChange,\n\t\t\tdisabled: _properties.disabled,\n\t\t\tproperties: _properties.properties,\n\t\t\tincrementIconName: _properties.incrementIconName,\n\t\t\tdecrementIconName: _properties.decrementIconName,\n\t\t\tsuffix: _properties.suffix,\n\t\t\tdecimalPlaces: _properties.decimalPlaces || 0,\n\t\t\tonRender: this.onRender.bind(this)\n\t\t};\n\t\tthis.svalue = _properties.initialValue || this.properties.min || 0;\n\t}\n\n\tpublic render(): void {\n\t\tif (!this.elem) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onRender(this.elem);\n\t}\n\n\tprivate onRender(elem: HTMLElement, ctx?: any, changeCallback?: (targetProperty?: string, newValue?: any) => void): void {\n\t\tif (!this.elem) {\n\t\t\tthis.elem = elem;\n\t\t}\n\t\tthis.changeCB = changeCallback;\n\n\t\tconst element: React.ReactElement<IPropertyFieldSpinButtonHostProps> = React.createElement(PropertyFieldSpinButtonHost, {\n\t\t\tlabel: this.properties.label,\n\t\t\tdisabled: this.properties.disabled,\n\t\t\tvalue: this.formatValueString(this.svalue),\n\t\t\tincrementIconName: this.properties.incrementIconName || 'ChevronUpSmall',\n\t\t\tdecrementIconName: this.properties.decrementIconName || 'ChevronDownSmall',\n\t\t\tonValidate: this.validate.bind(this),\n\t\t\tonIncrement: this.increment.bind(this),\n      onDecrement: this.decrement.bind(this)\n\t\t});\n\t\tReactDom.render(element, elem);\n\t}\n\n\tprivate validate(rawValue: string): string {\n\t\tlet numValue: number = this.extractNumValue(rawValue);\n\n\t\treturn this.validateNumber(numValue);\n\t}\n\n\tprivate validateNumber(numValue: number): string {\n\t\t// Check against max value\n\t\tif(typeof this.properties.max !== \"undefined\" && numValue > this.properties.max) {\n\t\t\tnumValue = this.properties.max;\n\t\t}\n\t\t// Check against min value\n\t\tif(typeof this.properties.min !== \"undefined\" && numValue < this.properties.min) {\n\t\t\tnumValue = this.properties.min;\n\t\t}\n\t\t//ensure matching rounding for decimals\n\t\tnumValue = +numValue.toFixed(this.properties.decimalPlaces);\n\t\t//Check for change and notify\n\t\tif(numValue !== this.svalue) {\n\t\t\tthis.onValueChanged(numValue);\n\t\t}\n\t\treturn this.formatValueString(numValue);\n\t}\n\n\tprivate increment(rawValue: string): string {\n\t\tlet numValue: number = this.extractNumValue(rawValue);\n\n\t\tnumValue += this.properties.step;\n\n\t\treturn this.validateNumber(numValue);\n\t}\n\n\tprivate decrement(rawValue: string): string {\n\t\tlet numValue: number = this.extractNumValue(rawValue);\n\n\t\tnumValue -= this.properties.step;\n\n\t\treturn this.validateNumber(numValue);\n\t}\n\n\tprivate extractNumValue(rawValue: string): number {\n\t\tlet numValue: number;\n\t\tlet baseValue: string = this.removeSuffix(rawValue);\n\n\t\tif(isNaN(+baseValue)){\n\t\t\tif(this.properties.min) {\n\t\t\t\tnumValue = Math.max(this.properties.min,0);\n\t\t\t} else {\n\t\t\t\tnumValue = 0;\n\t\t\t}\n\t\t} else {\n\t\t\tnumValue = +baseValue;\n\t\t}\n\n\t\treturn numValue;\n\t}\n\n\tprivate hasSuffix(rawValue: string): boolean {\n\t\tif(!this.properties.suffix) {\n\t\t\treturn false;\n\t\t}\n\t\tlet subString: string = rawValue.substr(rawValue.length - this.properties.suffix.length);\n\t\treturn subString === this.properties.suffix;\n\t}\n\n\tprivate removeSuffix(rawValue: string): string {\n\t\tif (!this.hasSuffix(rawValue)) {\n\t\t\treturn rawValue;\n\t\t}\n\n\t\treturn rawValue.substr(0, rawValue.length - this.properties.suffix.length);\n\t}\n\n\tprivate formatValueString(numValue: number): string {\n\t\treturn this.addSuffix(numValue.toFixed(this.properties.decimalPlaces));\n\t}\n\n\tprivate addSuffix(stringValue: string): string {\n\t\tif(!this.properties.suffix){\n\t\t\treturn stringValue;\n\t\t}\n\n\t\treturn stringValue + this.properties.suffix;\n\t}\n\n\tprivate onValueChanged(newValue: number): void {\n\t\tif (this.properties.onPropertyChange && newValue !== null) {\n\t\t\tthis.properties.onPropertyChange(this.targetProperty, this.svalue, newValue);\n\t\t\tthis.svalue = newValue;\n\t\t\tthis.properties.properties[this.targetProperty] = newValue;\n\t\t\tif (typeof this.changeCB !== 'undefined' && this.changeCB !== null) {\n\t\t\t\tthis.changeCB(this.targetProperty, newValue);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function PropertyFieldSpinButton(targetProperty: string, properties: IPropertyFieldSpinButtonProps): IPropertyPaneField<IPropertyFieldSpinButtonProps> {\n\treturn new PropertyFieldSpinButtonBuilder(targetProperty, properties);\n}\n"],"sourceRoot":"../../../src"}
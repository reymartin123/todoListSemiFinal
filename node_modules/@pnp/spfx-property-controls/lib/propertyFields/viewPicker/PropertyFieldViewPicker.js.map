{"version":3,"sources":["propertyFields/viewPicker/PropertyFieldViewPicker.ts"],"names":[],"mappings":"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","file":"propertyFields/viewPicker/PropertyFieldViewPicker.js","sourcesContent":["import * as React from 'react';\nimport * as ReactDom from 'react-dom';\nimport {\n  IPropertyPaneField,\n  PropertyPaneFieldType,\n  IWebPartContext\n} from '@microsoft/sp-webpart-base';\nimport PropertyFieldViewPickerHost from './PropertyFieldViewPickerHost';\nimport { IPropertyFieldViewPickerHostProps } from './IPropertyFieldViewPickerHost';\nimport { PropertyFieldViewPickerOrderBy, IPropertyFieldViewPickerProps, IPropertyFieldViewPickerPropsInternal } from './IPropertyFieldViewPicker';\nimport { ISPView } from '.';\n\n/**\n * Represents a PropertyFieldViewPicker object\n */\nclass PropertyFieldViewPickerBuilder implements IPropertyPaneField<IPropertyFieldViewPickerPropsInternal> {\n\n  //Properties defined by IPropertyPaneField\n  public properties: IPropertyFieldViewPickerPropsInternal;\n  public targetProperty: string;\n  public type: PropertyPaneFieldType = PropertyPaneFieldType.Custom;\n\n  //Custom properties label: string;\n  private context: IWebPartContext;\n  private label: string;\n  private listId?: string;\n  private orderBy: PropertyFieldViewPickerOrderBy;\n  private selectedView: string;\n  private viewsToExclude: string[];\n\n  private customProperties: any;\n  private deferredValidationTime: number = 200;\n  private disabled: boolean = false;\n  private disableReactivePropertyChanges: boolean = false;\n  private filter: string;\n  private key: string;\n  private webAbsoluteUrl?: string;\n  private onGetErrorMessage: (value: string) => string | Promise<string>;\n  private onViewsRetrieved?: (views: ISPView[]) => PromiseLike<ISPView[]> | ISPView[];\n  public onPropertyChange(propertyPath: string, oldValue: any, newValue: any): void { }\n  private renderWebPart: () => void;\n\n  /**\n   * Constructor method\n   */\n  public constructor(_targetProperty: string, _properties: IPropertyFieldViewPickerPropsInternal) {\n    this.render = this.render.bind(this);\n    this.targetProperty = _targetProperty;\n    this.properties = _properties;\n    this.properties.onDispose = this.dispose;\n    this.properties.onRender = this.render;\n    this.label = _properties.label;\n    this.context = _properties.context;\n    this.webAbsoluteUrl = _properties.webAbsoluteUrl;\n    this.listId = _properties.listId;\n    this.selectedView = _properties.selectedView;\n    this.orderBy = _properties.orderBy;\n    this.onPropertyChange = _properties.onPropertyChange;\n    this.customProperties = _properties.properties;\n    this.key = _properties.key;\n    this.viewsToExclude = _properties.viewsToExclude;\n    this.filter = _properties.filter;\n    this.onGetErrorMessage = _properties.onGetErrorMessage;\n    this.onViewsRetrieved = _properties.onViewsRetrieved;\n\n    if (_properties.disabled === true) {\n      this.disabled = _properties.disabled;\n    }\n    if (_properties.deferredValidationTime) {\n      this.deferredValidationTime = _properties.deferredValidationTime;\n    }\n  }\n\n  /**\n   * Renders the SPViewPicker field content\n   */\n  private render(elem: HTMLElement, ctx?: any, changeCallback?: (targetProperty?: string, newValue?: any) => void): void {\n    const componentProps = {\n      label: this.label,\n      targetProperty: this.targetProperty,\n      context: this.context,\n      webAbsoluteUrl: this.webAbsoluteUrl,\n      listId: this.listId,\n      orderBy: this.orderBy,\n      onDispose: this.dispose,\n      onRender: this.render,\n      onChange: changeCallback,\n      onPropertyChange: this.onPropertyChange,\n      properties: this.customProperties,\n      key: this.key,\n      disabled: this.disabled,\n      onGetErrorMessage: this.onGetErrorMessage,\n      deferredValidationTime: this.deferredValidationTime,\n      viewsToExclude: this.viewsToExclude,\n      filter: this.filter,\n      onViewsRetrieved: this.onViewsRetrieved\n    };\n\n      // Single selector\n      componentProps['selectedView'] = this.selectedView;\n      const element: React.ReactElement<IPropertyFieldViewPickerHostProps> = React.createElement(PropertyFieldViewPickerHost, componentProps);\n      // Calls the REACT content generator\n      ReactDom.render(element, elem);\n  }\n\n  /**\n   * Disposes the current object\n   */\n  private dispose(_elem: HTMLElement): void {\n\n  }\n\n}\n\n/**\n * Helper method to create a SPView Picker on the PropertyPane.\n * @param targetProperty - Target property the SharePoint view picker is associated to.\n * @param properties - Strongly typed SPView Picker properties.\n */\nexport function PropertyFieldViewPicker(targetProperty: string, properties: IPropertyFieldViewPickerProps): IPropertyPaneField<IPropertyFieldViewPickerPropsInternal> {\n\n  //Create an internal properties object from the given properties\n  const newProperties: IPropertyFieldViewPickerPropsInternal = {\n    label: properties.label,\n    targetProperty: targetProperty,\n    context: properties.context,\n    listId: properties.listId,\n    selectedView: typeof properties.selectedView === 'string' ? properties.selectedView : null,\n    onPropertyChange: properties.onPropertyChange,\n    properties: properties.properties,\n    onDispose: null,\n    onRender: null,\n    key: properties.key,\n    disabled: properties.disabled,\n    viewsToExclude: properties.viewsToExclude,\n    webAbsoluteUrl: properties.webAbsoluteUrl,\n    filter: properties.filter,\n    onGetErrorMessage: properties.onGetErrorMessage,\n    deferredValidationTime: properties.deferredValidationTime,\n    onViewsRetrieved: properties.onViewsRetrieved\n  };\n  //Calls the PropertyFieldViewPicker builder object\n  //This object will simulate a PropertyFieldCustom to manage his rendering process\n  return new PropertyFieldViewPickerBuilder(targetProperty, newProperties);\n}\n"],"sourceRoot":"../../../src"}
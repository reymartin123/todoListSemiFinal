{"version":3,"sources":["propertyFields/termPicker/PropertyFieldTermPickerHost.tsx"],"names":[],"mappings":";;;;;;;;;;;;AAAA,6BAA+B;AAC/B,kEAA6D;AAC7D,4DAA6F;AAC7F,0DAAoE;AACpE,8DAA0E;AAC1E,0DAAyD;AACzD,2CAAsC;AAKtC,qGAA+D;AAC/D,gEAAwE;AACxE,yCAAoC;AACpC,uEAAkE;AAClE,kDAAoD;AACpD,gDAAkD;AAElD;;GAEG;AACU,QAAA,aAAa,GAAG,oaAAoa,CAAC,CAAC,uCAAuC;AAC7d,QAAA,YAAY,GAAG,gXAAgX,CAAC,CAAC,sCAAsC;AACva,QAAA,SAAS,GAAG,oaAAoa,CAAC,CAAC,mCAAmC;AACrd,QAAA,WAAW,GAAG,oXAAoX,CAAC,CAAC,qCAAqC;AAGtb;;GAEG;AACH;IAAyD,+CAAqF;IAO5I;;OAEG;IACH,qCAAY,KAAwC;QAApD,YACE,kBAAM,KAAK,CAAC,SA8Bb;QArCO,oBAAc,GAAiB,EAAE,CAAC;QAClC,YAAM,GAAY,IAAI,CAAC;QAQ7B,SAAS,CAAC,KAAK,CAAC,yBAAyB,EAAE;YACzC,uBAAuB,EAAE,KAAK,CAAC,uBAAuB;YACtD,kBAAkB,EAAE,KAAK,CAAC,kBAAkB;YAC5C,sBAAsB,EAAE,CAAC,CAAC,KAAK,CAAC,sBAAsB;YACtD,oBAAoB,EAAE,CAAC,CAAC,KAAK,CAAC,oBAAoB;YAClD,QAAQ,EAAE,KAAK,CAAC,QAAQ;SACzB,CAAC,CAAC;QAEH,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC,WAAW,CAAC;QAGtC,KAAI,CAAC,KAAK,GAAG;YACX,WAAW,EAAE,OAAO,KAAI,CAAC,KAAK,CAAC,aAAa,KAAK,WAAW,GAAG,KAAI,CAAC,KAAK,CAAC,aAAa,GAAG,EAAE;YAC5F,UAAU,EAAE,EAAE;YACd,MAAM,EAAE,KAAK;YACb,SAAS,EAAE,KAAK;YAChB,YAAY,EAAE,EAAE;SACjB,CAAC;QAEF,KAAI,CAAC,WAAW,GAAG,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/C,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrC,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACjD,KAAI,CAAC,KAAK,GAAG,IAAI,iBAAK,CAAC,KAAI,CAAC,CAAC;QAC7B,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACzC,KAAI,CAAC,sBAAsB,GAAG,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QACrE,KAAI,CAAC,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC;QAC/D,KAAI,CAAC,eAAe,GAAG,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAC;;IAC/F,CAAC;IAED;;OAEG;IACK,oDAAc,GAAtB;QAAA,iBAeC;QAdC,IAAI,CAAC,YAAY,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC,UAAC,QAAsB;YAC5D,oCAAoC;YACpC,EAAE,CAAC,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;gBACtB,KAAI,CAAC,QAAQ,CAAC;oBACZ,UAAU,EAAE,QAAQ;oBACpB,MAAM,EAAE,IAAI;iBACb,CAAC,CAAC;YACL,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,QAAQ,CAAC;oBACZ,UAAU,EAAE,EAAE;oBACd,MAAM,EAAE,IAAI;iBACb,CAAC,CAAC;YACL,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACK,8CAAQ,GAAhB,UAAiB,KAAmB;QAApC,iBA4BC;QA3BC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,iBAAiB,KAAK,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,iBAAiB,KAAK,SAAS,CAAC,CAAC,CAAC;YACxF,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;YAC1D,MAAM,CAAC;QACT,CAAC;QAED,IAAM,MAAM,GAAiC,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;QACvF,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC;YAClC,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,QAAQ,CAAC,CAAC,CAAC;gBAC/B,EAAE,CAAC,CAAC,MAAM,KAAK,EAAE,CAAC,CAAC,CAAC;oBAClB,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;gBAC5D,CAAC;gBACD,IAAI,CAAC,QAAQ,CAAC;oBACZ,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;YACL,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,MAAM,CAAC,IAAI,CAAC,UAAC,YAAoB;oBAC/B,EAAE,CAAC,CAAC,OAAO,YAAY,KAAK,WAAW,IAAI,YAAY,KAAK,EAAE,CAAC,CAAC,CAAC;wBAC/D,KAAI,CAAC,mBAAmB,CAAC,KAAI,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;oBAC5D,CAAC;oBACD,KAAI,CAAC,QAAQ,CAAC;wBACZ,YAAY,EAAE,YAAY;qBAC3B,CAAC,CAAC;gBACL,CAAC,CAAC,CAAC;YACL,CAAC;QACH,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAC5D,CAAC;IACH,CAAC;IAED;;OAEG;IACK,yDAAmB,GAA3B,UAA4B,QAAsB,EAAE,QAAsB;QACxE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;YACrD,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,GAAG,QAAQ,CAAC;YAC5D,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YAC3E,2BAA2B;YAC3B,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,KAAK,WAAW,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;gBAC/E,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC;YAC3D,CAAC;QACH,CAAC;IACH,CAAC;IAGD;;OAEG;IACK,iDAAW,GAAnB;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC;YACjC,MAAM,CAAC;QACT,CAAC;QAED,+BAA+B;QAC/B,IAAI,CAAC,cAAc,GAAG,4BAAS,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QACxD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QAEnB,IAAI,CAAC,cAAc,EAAE,CAAC;QAEtB,IAAI,CAAC,QAAQ,CAAC;YACZ,SAAS,EAAE,IAAI;YACf,MAAM,EAAE,KAAK;SACd,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACK,kDAAY,GAApB;QAAA,iBAeC;QAbC,IAAI,CAAC,QAAQ,CAAC;YACZ,IAAM,QAAQ,GAAsC;gBAClD,SAAS,EAAE,KAAK;gBAChB,MAAM,EAAE,KAAK;aACd,CAAC;YAEF,wCAAwC;YACxC,EAAE,CAAC,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC,CAAC;gBAChB,QAAQ,CAAC,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC;YAC7C,CAAC;YAED,MAAM,CAAC,QAAQ,CAAC;QAClB,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACK,4CAAM,GAAd;QACE,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;QAC7C,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAED;;;OAGG;IACK,kDAAY,GAApB,UAAqB,IAAW,EAAE,SAAiB,EAAE,OAAgB;QAEnE,IAAI,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;QACzC,EAAE,CAAC,CAAC,OAAO,IAAI,KAAK,WAAW,IAAI,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC;YACjD,MAAM,CAAC;QACT,CAAC;QAED,6CAA6C;QAC7C,IAAM,QAAQ,GAAgB;YAC5B,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,GAAG,EAAE,IAAI,CAAC,EAAE;YACZ,IAAI,EAAE,IAAI,CAAC,UAAU;YACrB,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE;YACxB,SAAS,EAAE,SAAS;YACpB,MAAM,EAAE,IAAI,CAAC,MAAM;SACpB,CAAC;QAEF,4CAA4C;QAC5C,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACZ,kDAAkD;YAClD,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAAC;gBACvC,uBAAuB;gBACvB,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC3B,iCAAiC;gBACjC,WAAW,GAAG,yBAAM,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;YAC3C,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,uCAAuC;gBACvC,WAAW,GAAG,CAAC,QAAQ,CAAC,CAAC;YAC3B,CAAC;QACH,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,gDAAgD;YAChD,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,GAAG,KAAK,IAAI,CAAC,EAAE,EAApB,CAAoB,CAAC,CAAC;QACjE,CAAC;QACD,wBAAwB;QACxB,WAAW,GAAG,yBAAM,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;QAC1C,2BAA2B;QAC3B,IAAI,CAAC,QAAQ,CAAC;YACZ,WAAW,EAAE,WAAW;SACzB,CAAC,CAAC;IACL,CAAC;IAED;;;KAGC;IACO,4DAAsB,GAA9B,UAA+B,KAAmB;QAChD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;QAE5B,IAAI,CAAC,QAAQ,CAAC;YACZ,WAAW,EAAE,KAAK;SACnB,CAAC,CAAC;IACL,CAAC;IAGD;;;OAGG;IACK,6DAAuB,GAA/B,UAAgC,IAAiB;QAC/C,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACvD,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,KAAK,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC/C,MAAM,CAAC,CAAC,CAAC;YACX,CAAC;QACH,CAAC;QACD,MAAM,CAAC,CAAC,CAAC,CAAC;IACZ,CAAC;IAED;;OAEG;IACI,0DAAoB,GAA3B;QACE,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,KAAK,KAAK,WAAW,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;QACvB,CAAC;IACH,CAAC;IAED;;OAEG;IACI,4CAAM,GAAb;QAAA,iBAkFC;QAjFC,MAAM,CAAC,CACL;YACG,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,oBAAC,aAAK,QAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAS;YACtD,+BAAO,SAAS,EAAE,iDAAM,CAAC,cAAc;gBACrC;oBACE;wBACE;4BACE,oBAAC,oBAAU,IACT,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAC3B,mBAAmB,EAAE,IAAI,CAAC,KAAK,EAC/B,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAC7B,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAC7B,SAAS,EAAE,IAAI,CAAC,sBAAsB,EACtC,uBAAuB,EAAE,IAAI,CAAC,KAAK,CAAC,uBAAuB,EAC3D,mBAAmB,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,EACnD,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,eAAe,EAC3C,YAAY,EAAE,IAAI,CAAC,YAAY,EAC/B,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,KAAK,SAAS,GAAG,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,GACnF,CACC;wBACL,4BAAI,SAAS,EAAE,iDAAM,CAAC,YAAY;4BAChC,oBAAC,mBAAU,IAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,WAAW,GAAI,CACrG,CACF,CACC,CACF;YAER,oBAAC,2BAAiB,IAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,YAAY,GAAI;YAE5D,oBAAC,aAAK,IACJ,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,EAC5B,cAAc,EAAE,IAAI,EACpB,SAAS,EAAE,IAAI,CAAC,YAAY,EAC5B,cAAc,EAAE,IAAI,EACpB,IAAI,EAAE,iBAAS,CAAC,MAAM,EACtB,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,UAAU,EACjC,qBAAqB,EAAE;oBACrB,MAAM,CAAC,CACL,6BAAK,SAAS,EAAE,iDAAM,CAAC,OAAO;wBAC5B,oBAAC,sBAAa,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,eAAe,EAAE,KAAK,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,EAAE,KAAI,CAAC,MAAM,GAAI;wBAEvI,oBAAC,sBAAa,IAAC,SAAS,EAAE,EAAE,QAAQ,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,iBAAiB,EAAE,KAAK,EAAE,OAAO,CAAC,iBAAiB,EAAE,OAAO,EAAE,KAAI,CAAC,YAAY,GAAI,CAC/I,CACP,CAAC;gBACJ,CAAC;gBAGC,sDAAsD;gBACtD,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,KAAK,GAAG,oBAAC,iBAAO,IAAC,IAAI,EAAE,qBAAW,CAAC,MAAM,GAAI,GAAG,EAAE;gBAKxE,gFAAgF;gBAChF,IAAI,CAAC,KAAK,CAAC,MAAM,KAAK,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,UAAC,SAAqB,EAAE,KAAa;oBAE1F,MAAM,CAAC,CACL,6BAAK,GAAG,EAAE,SAAS,CAAC,EAAE;wBAElB,CAAC,KAAI,CAAC,KAAK,CAAC,iBAAiB,GAAG,gCAAK,SAAS,CAAC,IAAI,CAAM,GAAG,IAAI;wBAGhE,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,CAAC,aAAa,IAAI,SAAS,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,UAAC,KAAK;4BAC7F,MAAM,CAAC,oBAAC,mBAAS,IAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAC7B,KAAK,EAAE,KAAK,EACZ,SAAS,EAAE,SAAS,CAAC,EAAE,EACvB,YAAY,EAAE,KAAI,CAAC,YAAY,EAC/B,WAAW,EAAE,KAAI,CAAC,KAAK,CAAC,WAAW,EACnC,eAAe,EAAE,KAAI,CAAC,YAAY,EAClC,cAAc,EAAE,KAAI,CAAC,KAAK,CAAC,uBAAuB,EAClD,mBAAmB,EAAE,KAAI,CAAC,KAAK,CAAC,mBAAmB,EACnD,eAAe,EAAE,KAAI,CAAC,KAAK,CAAC,eAAe,GAAI,CAAC;wBACpD,CAAC,CAAC,CAEA,CACP,CAAC;gBACJ,CAAC,CAAC,GAAG,EAAE,CAEH,CACJ,CACP,CAAC;IACJ,CAAC;IACH,kCAAC;AAAD,CAtUA,AAsUC,CAtUwD,KAAK,CAAC,SAAS,GAsUvE","file":"propertyFields/termPicker/PropertyFieldTermPickerHost.js","sourcesContent":["import * as React from 'react';\nimport { Async } from 'office-ui-fabric-react/lib/Utilities';\nimport { PrimaryButton, DefaultButton, IconButton } from 'office-ui-fabric-react/lib/Button';\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel';\nimport { Spinner, SpinnerType } from 'office-ui-fabric-react/lib/Spinner';\nimport { Label } from 'office-ui-fabric-react/lib/Label';\nimport TermPicker from './TermPicker';\n\nimport { IPickerTerms, IPickerTerm } from './IPropertyFieldTermPicker';\nimport { IPropertyFieldTermPickerHostProps, IPropertyFieldTermPickerHostState } from './IPropertyFieldTermPickerHost';\nimport { ITermStore, ITerm, ISPTermStorePickerService } from './../../services/ISPTermStorePickerService';\nimport styles from './PropertyFieldTermPickerHost.module.scss';\nimport { sortBy, uniqBy, cloneDeep } from '@microsoft/sp-lodash-subset';\nimport TermGroup from './TermGroup';\nimport FieldErrorMessage from '../errorMessage/FieldErrorMessage';\nimport * as telemetry from '../../common/telemetry';\nimport * as strings from 'PropertyControlStrings';\n\n/**\n * Image URLs / Base64\n */\nexport const COLLAPSED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAIJJREFUOE/NkjEKwCAMRdu7ewZXJ/EqHkJwE9TBCwR+a6FLUQsRwYBTeD8/35wADnZVmPvY4OOYO3UNbK1FKeUWH+fRtK21hjEG3vuhQBdOKUEpBedcV6ALExFijJBSIufcFBjCVSCEACEEqpNvBmsmT+3MTnvqn/+O4+1vdtv7274APmNjtuXVz6sAAAAASUVORK5CYII='; // /_layouts/15/images/MDNCollapsed.png\nexport const EXPANDED_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAUCAYAAABSx2cSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjEwcrIlkgAAAFtJREFUOE9j/P//PwPZAKSZXEy2RrCLybV1CGjetWvX/46ODqBLUQOXoJ9BGtXU1MCYJM0wjZGRkaRpRtZIkmZ0jSRpBgUOzJ8wmqwAw5eICIb2qGYSkyfNAgwAasU+UQcFvD8AAAAASUVORK5CYII='; // /_layouts/15/images/MDNExpanded.png\nexport const GROUP_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAC9SURBVDhPY2CgNXh1qEkdiJ8D8X90TNBuJM0V6IpBhoHFgIxebKYTIwYzAMNpxGhGdsFwNoBgNEFjAWsYgOSKiorMgPgbEP/Hgj8AxXpB0Yg1gQAldYuLix8/efLkzn8s4O7du9eAan7iM+DV/v37z546der/jx8/sJkBdhVOA5qbm08ePnwYrOjQoUOkGwDU+AFowLmjR4/idwGukAYaYAkMgxfPnj27h816kDg4DPABoAI/IP6DIxZA4l0AOd9H3QXl5+cAAAAASUVORK5CYII='; // /_layouts/15/Images/EMMGroup.png\nexport const TERMSET_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACaSURBVDhPrZLRCcAgDERdpZMIjuQA7uWH4CqdxMY0EQtNjKWB0A/77sxF55SKMTalk8a61lqCFqsLiwKac84ZRUUBi7MoYHVmAfjfjzE6vJqZQfie0AcwBQVW8ATi7AR7zGGGNSE6Q2cyLSPIjRswjO7qKhcPDN2hK46w05wZMcEUIG+HrzzcrRsQBIJ5hS8C9fGAPmRwu/9RFxW6L8CM4Ry8AAAAAElFTkSuQmCC'; // /_layouts/15/Images/EMMTermSet.png\n\n\n/**\n * Renders the controls for PropertyFieldTermPicker component\n */\nexport default class PropertyFieldTermPickerHost extends React.Component<IPropertyFieldTermPickerHostProps, IPropertyFieldTermPickerHostState> {\n  private async: Async;\n  private delayedValidate: (value: IPickerTerms) => void;\n  private termsService: ISPTermStorePickerService;\n  private previousValues: IPickerTerms = [];\n  private cancel: boolean = true;\n\n  /**\n   * Constructor method\n   */\n  constructor(props: IPropertyFieldTermPickerHostProps) {\n    super(props);\n\n    telemetry.track('PropertyFieldTermPicker', {\n      allowMultipleSelections: props.allowMultipleSelections,\n      excludeSystemGroup: props.excludeSystemGroup,\n      limitByTermsetNameOrID: !!props.limitByTermsetNameOrID,\n      limitByGroupNameOrID: !!props.limitByGroupNameOrID,\n      disabled: props.disabled\n    });\n\n    this.termsService = props.termService;\n\n\n    this.state = {\n      activeNodes: typeof this.props.initialValues !== 'undefined' ? this.props.initialValues : [],\n      termStores: [],\n      loaded: false,\n      openPanel: false,\n      errorMessage: ''\n    };\n\n    this.onOpenPanel = this.onOpenPanel.bind(this);\n    this.onClosePanel = this.onClosePanel.bind(this);\n    this.onSave = this.onSave.bind(this);\n    this.termsChanged = this.termsChanged.bind(this);\n    this.async = new Async(this);\n    this.validate = this.validate.bind(this);\n    this.termsFromPickerChanged = this.termsFromPickerChanged.bind(this);\n    this.notifyAfterValidate = this.notifyAfterValidate.bind(this);\n    this.delayedValidate = this.async.debounce(this.validate, this.props.deferredValidationTime);\n  }\n\n  /**\n   * Loads the list from SharePoint current web site\n   */\n  private loadTermStores(): void {\n    this.termsService.getTermStores().then((response: ITermStore[]) => {\n      // Check if a response was retrieved\n      if (response !== null) {\n        this.setState({\n          termStores: response,\n          loaded: true\n        });\n      } else {\n        this.setState({\n          termStores: [],\n          loaded: true\n        });\n      }\n    });\n  }\n\n  /**\n   * Validates the new custom field value\n   */\n  private validate(value: IPickerTerms): void {\n    if (this.props.onGetErrorMessage === null || this.props.onGetErrorMessage === undefined) {\n      this.notifyAfterValidate(this.props.initialValues, value);\n      return;\n    }\n\n    const result: string | PromiseLike<string> = this.props.onGetErrorMessage(value || []);\n    if (typeof result !== 'undefined') {\n      if (typeof result === 'string') {\n        if (result === '') {\n          this.notifyAfterValidate(this.props.initialValues, value);\n        }\n        this.setState({\n          errorMessage: result\n        });\n      } else {\n        result.then((errorMessage: string) => {\n          if (typeof errorMessage === 'undefined' || errorMessage === '') {\n            this.notifyAfterValidate(this.props.initialValues, value);\n          }\n          this.setState({\n            errorMessage: errorMessage\n          });\n        });\n      }\n    } else {\n      this.notifyAfterValidate(this.props.initialValues, value);\n    }\n  }\n\n  /**\n   * Notifies the parent Web Part of a property value change\n   */\n  private notifyAfterValidate(oldValue: IPickerTerms, newValue: IPickerTerms) {\n    if (this.props.onPropertyChange && newValue !== null) {\n      this.props.properties[this.props.targetProperty] = newValue;\n      this.props.onPropertyChange(this.props.targetProperty, oldValue, newValue);\n      // Trigger the apply button\n      if (typeof this.props.onChange !== 'undefined' && this.props.onChange !== null) {\n        this.props.onChange(this.props.targetProperty, newValue);\n      }\n    }\n  }\n\n\n  /**\n   * Open the right Panel\n   */\n  private onOpenPanel(): void {\n    if (this.props.disabled === true) {\n      return;\n    }\n\n    // Store the current code value\n    this.previousValues = cloneDeep(this.state.activeNodes);\n    this.cancel = true;\n\n    this.loadTermStores();\n\n    this.setState({\n      openPanel: true,\n      loaded: false\n    });\n  }\n\n  /**\n   * Close the panel\n   */\n  private onClosePanel(): void {\n\n    this.setState(() => {\n      const newState: IPropertyFieldTermPickerHostState = {\n        openPanel: false,\n        loaded: false\n      };\n\n      // Check if the property has to be reset\n      if (this.cancel) {\n        newState.activeNodes = this.previousValues;\n      }\n\n      return newState;\n    });\n  }\n\n  /**\n   * On save click action\n   */\n  private onSave(): void {\n    this.cancel = false;\n    this.delayedValidate(this.state.activeNodes);\n    this.onClosePanel();\n  }\n\n  /**\n   * Clicks on a node\n   * @param node\n   */\n  private termsChanged(term: ITerm, termGroup: string, checked: boolean): void {\n\n    let activeNodes = this.state.activeNodes;\n    if (typeof term === 'undefined' || term === null) {\n      return;\n    }\n\n    // Term item to add to the active nodes array\n    const termItem: IPickerTerm = {\n      name: term.Name,\n      key: term.Id,\n      path: term.PathOfTerm,\n      termSet: term.TermSet.Id,\n      termGroup: termGroup,\n      labels: term.Labels\n    };\n\n    // Check if the term is checked or unchecked\n    if (checked) {\n      // Check if it is allowed to select multiple terms\n      if (this.props.allowMultipleSelections) {\n        // Add the checked term\n        activeNodes.push(termItem);\n        // Filter out the duplicate terms\n        activeNodes = uniqBy(activeNodes, 'key');\n      } else {\n        // Only store the current selected item\n        activeNodes = [termItem];\n      }\n    } else {\n      // Remove the term from the list of active nodes\n      activeNodes = activeNodes.filter(item => item.key !== term.Id);\n    }\n    // Sort all active nodes\n    activeNodes = sortBy(activeNodes, 'path');\n    // Update the current state\n    this.setState({\n      activeNodes: activeNodes\n    });\n  }\n\n  /**\n * Fires When Items Changed in TermPicker\n * @param node\n */\n  private termsFromPickerChanged(terms: IPickerTerms) {\n    this.delayedValidate(terms);\n\n    this.setState({\n      activeNodes: terms\n    });\n  }\n\n\n  /**\n   * Gets the given node position in the active nodes collection\n   * @param node\n   */\n  private getSelectedNodePosition(node: IPickerTerm): number {\n    for (let i = 0; i < this.state.activeNodes.length; i++) {\n      if (node.key === this.state.activeNodes[i].key) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Called when the component will unmount\n   */\n  public componentWillUnmount() {\n    if (typeof this.async !== 'undefined') {\n      this.async.dispose();\n    }\n  }\n\n  /**\n   * Renders the SPListpicker controls with Office UI  Fabric\n   */\n  public render(): JSX.Element {\n    return (\n      <div>\n        {this.props.label && <Label>{this.props.label}</Label>}\n        <table className={styles.termFieldTable}>\n          <tbody>\n            <tr>\n              <td>\n                <TermPicker\n                  context={this.props.context}\n                  termPickerHostProps={this.props}\n                  disabled={this.props.disabled}\n                  value={this.state.activeNodes}\n                  onChanged={this.termsFromPickerChanged}\n                  allowMultipleSelections={this.props.allowMultipleSelections}\n                  isTermSetSelectable={this.props.isTermSetSelectable}\n                  disabledTermIds={this.props.disabledTermIds}\n                  termsService={this.termsService}\n                  resolveDelay={this.props.resolveDelay === undefined ? 500 : this.props.resolveDelay} // in future this can be bubbled upper to the settings\n                />\n              </td>\n              <td className={styles.termFieldRow}>\n                <IconButton disabled={this.props.disabled} iconProps={{ iconName: 'Tag' }} onClick={this.onOpenPanel} />\n              </td>\n            </tr>\n          </tbody>\n        </table>\n\n        <FieldErrorMessage errorMessage={this.state.errorMessage} />\n\n        <Panel\n          isOpen={this.state.openPanel}\n          hasCloseButton={true}\n          onDismiss={this.onClosePanel}\n          isLightDismiss={true}\n          type={PanelType.medium}\n          headerText={this.props.panelTitle}\n          onRenderFooterContent={() => {\n            return (\n              <div className={styles.actions}>\n                <PrimaryButton iconProps={{ iconName: 'Save' }} text={strings.SaveButtonLabel} value={strings.SaveButtonLabel} onClick={this.onSave} />\n\n                <DefaultButton iconProps={{ iconName: 'Cancel' }} text={strings.CancelButtonLabel} value={strings.CancelButtonLabel} onClick={this.onClosePanel} />\n              </div>\n            );\n          }}>\n\n          {\n            /* Show spinner in the panel while retrieving terms */\n            this.state.loaded === false ? <Spinner type={SpinnerType.normal} /> : ''\n          }\n\n          {\n\n            /* Once the state is loaded, start rendering the term store, group, term sets */\n            this.state.loaded === true ? this.state.termStores.map((termStore: ITermStore, index: number) => {\n\n              return (\n                <div key={termStore.Id}>\n                  {\n                    !this.props.hideTermStoreName ? <h3>{termStore.Name}</h3> : null\n                  }\n                  {\n                    termStore.Groups && termStore.Groups._Child_Items_ && termStore.Groups._Child_Items_.map((group) => {\n                      return <TermGroup key={group.Id}\n                        group={group}\n                        termstore={termStore.Id}\n                        termsService={this.termsService}\n                        activeNodes={this.state.activeNodes}\n                        changedCallback={this.termsChanged}\n                        multiSelection={this.props.allowMultipleSelections}\n                        isTermSetSelectable={this.props.isTermSetSelectable}\n                        disabledTermIds={this.props.disabledTermIds} />;\n                    })\n                  }\n                </div>\n              );\n            }) : ''\n          }\n        </Panel>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"../../../src"}